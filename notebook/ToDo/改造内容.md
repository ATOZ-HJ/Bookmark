### 问题改造

#### Redis

1. 控制回测的最大并发数量；考虑在redis中设置一个全局变量表示当前回测数量
2. redis的集群部署方式，哨兵等
3. redis实现分布式锁，需要找出对应的场景
4. 首页中排行榜功能，热点数据处理（LRU）
5. redis实现队列，目前项目中有Kafka，这一点可以不去实现



#### 数据库

1. MySQL的数据库主备如何去做
2. 大数据量下的分库分表，数据同步，以及MySQL调优，映射到代码是sql语句优化
3. TiDB相关问题
   1. 因为什么问题迁移到了TiDB？TiDB 解决了Mysql的哪些不足？TiDB和Mysql的相比优劣？如果想要表达TiDB更快，用数据支撑。
4. 回测结果信息存储到MongoDB中，NoSQL数据库学习



### 分布式

1. 分布式id应用，集群环境下分布式id的生成方式
2. 集群环境下定时任务的实现方式(知道实现方式)，多个服务去redis中抢锁？
3. Kafka接受数据相关(待确认细节)



### 系统交互

1. 回测请求日志是如何推送到前端页面的？其他计算结果信息使用心跳机制(轮询)查询获取，日志使用ws推送
2. 发送到Python的回测请求如果迟迟没有响应怎么办？设计延时队列监控对方的响应情况，这个场景和淘宝等等支付场景中的下单30min未支付自动取消基本一致。(服务降级?)









### 开发计划

改造初步计划
功能开发方面
1 最大并发回测数量
执行: 先部署一个redis服务，然后开发修改原有接口，16号完成
2 查询接口调优
执行: 明确哪些接口需要调优，抛开业务从数据库层面哪些接口短期可以调优？索引的讲究，18号完成
3 计算结果数据存放NoSQL，需要学习用法，这里涉及到分页数据如何查询使用
执行: 先上手，三个明细数据直接存，考虑一下怎么存 怎么查的问题，额外部署一套nosql服务，20号完成
4 python超时未响应，如果一直有响应则一直刷新等待时间
执行: 参考创建订单监控未支付场景，学习延时队列的使用，22号完成
5 集群环境下定是任务处理问题
执行: 设计基于数据库的集群定时任务实现方案，感觉也不需要搞太多设计，我们只需要定时从数据库中读取要计算的内容即可，2天吧，24号完成，分布式定时任务处理问题
6 策略排行榜问题
执行: 考虑的点 项目启动后懒加载数据还是饿加载数据？何时出发数据的更新操作？这点业务上设计，一天 25号完成
7 回测接口的防重复请求设计
执行: 将请求参数和最近的请求时间存储在Redis中，每次请求过来先行判断，25号完成

架构设计方面
1 Redis技术选型问题，主从？哨兵？
执行: 需要稍微系统学习，半天搜集资料可以是极客时间或者博客，做调研，输出适合我们的方案，整体两天，27号完成，实操部署方案
2 MySQL主备？怎么操作？分库分表怎么搞？
执行: 大问题，3天，30号完成

搞完开始面向小怪找反馈
备注: 待新的问题发现即时更新并cover

持续深度思考问题
1 集群环境下多个服务如何不重复接收数据？我们不保证落入NoSQL中数据有序，那么我们提供给前端的查询接口如何保证有序？需要学习NoSQL相关API
2 绘制完整的数据流向处理图，检查哪个环节还有缺陷，主动找红军哥要反馈
3 待补充





### 开发列表



